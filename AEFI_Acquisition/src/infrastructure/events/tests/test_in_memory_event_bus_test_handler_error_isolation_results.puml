@startuml
title Sequence Diagram: test_handler_error_isolation
autonumber
skinparam responseMessageBelowArrow true
"Test" -> "InMemoryEventBus" : **CREATE** Initialize fresh bus
"Test" -> "InMemoryEventBus" : **SUBSCRIBE** Subscribe FailingHandler
note right
Data: {
  "event": "test_event"
}
end note
"Test" -> "InMemoryEventBus" : **SUBSCRIBE** Subscribe WorkingHandler
note right
Data: {
  "event": "test_event"
}
end note
"Test" -> "InMemoryEventBus" : **PUBLISH** Publish event
note right
Data: {
  "event": "test_event",
  "data": "test"
}
end note
"FailingHandler" -> "Test" : **ERROR** Handler raising error
note right
Data: {
  "data": "test"
}
end note
"WorkingHandler" -> "Test" : **RECEIVE** Handler called
note right
Data: {
  "data": "test"
}
end note
"Test" -> "InMemoryEventBus" : **ASSERT** Verify calls
note right
Expect: ['test']
Got: ['test']
end note
@enduml